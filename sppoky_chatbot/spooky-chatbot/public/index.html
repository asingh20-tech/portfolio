<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ðŸ‘» Spooky Chatbot</title>
  <link href="https://fonts.googleapis.com/css2?family=Creepster&display=swap" rel="stylesheet">
  <style>
   body {
  background: radial-gradient(circle at center, #003300 0%, #000000 80%);
  background-attachment: fixed;
  color: #00ff99; /* neon ghost green text */
  font-family: monospace;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding-top: 40px;
}



    h1 { animation: flicker 2s infinite alternate; }
    @keyframes flicker { from{opacity:1;} to{opacity:0.7;} }
    #chat { width:400px; height:400px; overflow-y:auto; background:#111; border:1px solid #0f0; padding:10px; border-radius:10px; margin-bottom:10px; }
    .msg { margin:8px 0; }
    .user { color:#ff66cc; text-align:right; }
    .bot { color:#00ff99; text-align:left; }
    input { width:320px; padding:8px; background:#222; border:none; color:#0f0; }
    button { padding:8px 10px; background:#00ff99; border:none; cursor:pointer; color:black; }
    /* Add skeleton animation */
    .skeleton {
      font-size: 30px;
      margin: 20px;
      animation: dance 1s infinite alternate;
    }

    @keyframes dance {
      0% { transform: rotate(-5deg) translateY(0); }
      50% { transform: rotate(5deg) translateY(-10px); }
      100% { transform: rotate(-5deg) translateY(0); }
    }

    /* Add glow effect */
    .glow {
      text-shadow: 0 0 10px #00ff99, 0 0 20px #00ff99, 0 0 30px #00ff99;
    }

    /* Add flash animation */
    @keyframes flash {
      0% { background: black; }
      50% { background: darkred; }
      100% { background: black; }
    }
    
    .flash {
      animation: flash 0.5s;
    }

    /* Scare button style */
    #scareBtn {
      margin-top: 20px;
      padding: 10px 20px;
      background: #ff0000;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-family: monospace;
      transition: transform 0.2s;
    }

    #scareBtn:hover {
      transform: scale(1.1);
    }

    /* Scare GIF overlay */
    .scare-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      z-index: 1000;
      justify-content: center;
      align-items: center;
    }

    .scare-gif {
      max-width: 90%;
      max-height: 90vh;
    }

    .show-scare {
      display: flex;
    }

    /* spooky text effect */
    .spooky-title {
      font-family: "Creepster", cursive;
      font-size: 3.5rem;
      color: #9f44ff; /* Changed to purple */
      text-shadow:
        0 0 10px #9f44ff,
        0 0 20px #6600cc,
        0 0 30px #330066;
      animation: flicker 1.5s infinite alternate;
      letter-spacing: 2px;
      text-transform: uppercase;
    }

    @keyframes flicker {
      0%   { opacity: 1; text-shadow: 0 0 5px #9f44ff, 0 0 15px #6600cc; }
      50%  { opacity: 0.7; text-shadow: 0 0 20px #bf80ff, 0 0 40px #6600cc; }
      100% { opacity: 0.9; text-shadow: 0 0 10px #9f44ff, 0 0 25px #330066; }
    }
  </style>
</head>
<body>
  <div class="skeleton">ðŸ’€</div>
  <h1 class="spooky-title">ðŸ’€ Spooky SUNY ðŸ’€</h1>
  <div id="chat"></div>
  <div>
    <input id="msg" placeholder="say something spooky...">
    <button onclick="sendMsg()">Send</button>
  </div>

  <!-- Add scare button below chat -->
  <button id="scareBtn" onclick="triggerScare()">ðŸ˜ˆ Scare Me... If You Dare!</button>
  
  <!-- Add audio element -->
  <audio id="scareSound" src="https://www.soundjay.com/human/sounds/scream-01.mp3" preload="auto"></audio>

  <!-- Update scare overlay with multiple GIFs -->
  <div id="scareOverlay" class="scare-overlay">
    <img class="scare-gif" alt="Scary Animation">
  </div>

  <script>
    const chat = document.getElementById('chat');
    const msg = document.getElementById('msg');

    function append(role, text) {
      const div = document.createElement('div');
      div.className = `msg ${role}`;
      div.textContent = text;
      chat.appendChild(div);
      chat.scrollTop = chat.scrollHeight;
    }

    async function sendMsg() {
      const text = msg.value.trim();
      if (!text) return;
      
      append('user', text);
      msg.value = '';
      
      try {
        const res = await fetch('/chat', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/json'
          },
          body: JSON.stringify({ message: text })
        });
        
        const data = await res.json();
        
        if (!res.ok) {
          throw new Error(data.error || 'Network response was not ok');
        }
        
        // Direct message display without animation
        append('bot', data.reply);
      } catch (error) {
        console.error('Error:', error);
        append('bot', 'ðŸ‘» Error: ' + (error.message || 'Failed to communicate with the spirits'));
      }
    }

    // Add Enter key support
    msg.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') sendMsg();
    });

    // Add initial greeting
    append('bot', 'ðŸ‘» Welcome mortal! Speak your fears...');

    // Add scary GIFs array
    const scaryGifs = [
      "https://media.giphy.com/media/MsJO9AUbrLWy4/giphy.gif",
      "https://media.giphy.com/media/HxZ3prK9hIDsc/giphy.gif",
      "https://media.giphy.com/media/XjmZtvmDMDPVSbhBqt/giphy.gif",
      "https://media1.giphy.com/media/ghzqRphWP2EjA3yuk1/giphy.gif"
    ];

    let lastGifIndex = -1; // Keep track of last shown GIF

    // Update scare function
    function triggerScare() {
      // Play sound
      const sound = document.getElementById('scareSound');
      sound.volume = 0.5;
      sound.play();
      
      // Show random GIF (but not the same one twice in a row)
      const overlay = document.getElementById('scareOverlay');
      const gifImg = overlay.querySelector('img');
      
      let randomIndex;
      do {
        randomIndex = Math.floor(Math.random() * scaryGifs.length);
      } while (randomIndex === lastGifIndex && scaryGifs.length > 1);
      
      lastGifIndex = randomIndex;
      gifImg.src = scaryGifs[randomIndex];
      overlay.classList.add('show-scare');
      
      // Flash effect
      document.body.classList.add('flash');
      
      // Hide overlay after 3 seconds
      setTimeout(() => {
        overlay.classList.remove('show-scare');
        document.body.classList.remove('flash');
      }, 3000);
      
      // Bot response
      const botDiv = document.createElement('div');
      botDiv.className = 'msg bot';
      chat.appendChild(botDiv);
      typeLetterByLetter("GOTCHA MORTAL! ðŸ˜ˆ Sweet nightmares...", botDiv);
      
      chat.scrollTop = chat.scrollHeight;
    }
  </script>
</body>
</html>
